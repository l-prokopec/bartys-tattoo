---
import BaseLayout from '../layouts/BaseLayout.astro';
import type { ImageMetadata } from 'astro';

const trashPolkaImages = Object.values(
  import.meta.glob<{ default: ImageMetadata }>(
    '../assets/portfolio/trash-polka/*.{png,jpg,jpeg,webp,avif}',
    { eager: true }
  )
);

const realismImages = Object.values(
  import.meta.glob<{ default: ImageMetadata }>(
    '../assets/portfolio/realistica/*.{png,jpg,jpeg,webp,avif}',
    { eager: true }
  )
);
---


<BaseLayout title="Bartys Tattoo - Portfolio">
  <section class="portfolio-section">
    
    <!-- Trash Polka -->
    <article class="portfolio-style">
      <header class="portfolio-style__header">
        <h1>Trash Polka</h1>
        <h2>Chaos a harmonie v jednom</h2>
      </header>

      <div class="portfolio-style__body">
        <div class="portfolio-description" data-expanded="false">
          <p>
            Trash Polka je výrazný a provokativní tetovací styl, který vznikl v Německu, ve studiu Buena Vista Tattoo
            Club (Simone Pfaff a Volko Merschky). Kombinuje realistické motivy s abstraktními prvky, často ve formě
            šmouh, skvrn, nápisů a geometrických tvarů. Typické je pro něj použití pouze černé a červené barvy, což
            vytváří silný kontrast a dramatický vizuální dojem.
          </p>
          <p>
            Styl Trash Polka působí, jako by byl „roztrhaný“ nebo „kolážovitý“ – spojuje krásu a zmatek, realitu a
            fikci, život a smrt. Často nese hluboké osobní nebo filozofické významy, které jsou podané ve vizuálně
            explozivní formě.
          </p>
        </div>

        <button class="portfolio-toggle" type="button">
          Více
        </button>

                <div class="portfolio-gallery">
          <button
            class="portfolio-gallery__arrow portfolio-gallery__arrow--prev"
            type="button"
            aria-label="Předchozí obrázek"
          >
            ←
          </button>

          <div class="portfolio-gallery__track">
            {trashPolkaImages.map((image, index) => (
              <figure class="portfolio-gallery__item">
                <img
                  src={image.default.src}
                  alt={`Trash Polka tetování ${index + 1}`}
                  loading="lazy"
                  class="portfolio-gallery__image"
                />
              </figure>
            ))}
          </div>

          <button
            class="portfolio-gallery__arrow portfolio-gallery__arrow--next"
            type="button"
            aria-label="Další obrázek"
          >
            →
          </button>
        </div>
      </div>
    </article>

    <!-- Realistika zvířat -->
    <article class="portfolio-style">
      <header class="portfolio-style__header">
        <h1>Realistika zvířat</h1>
        <h2>Síla přírody zachycená v inkoustu</h2>
      </header>

      <div class="portfolio-style__body">
        <div class="portfolio-description" data-expanded="false">
          <p>
            Tetování ve stylu realistiky zvířat se zaměřuje na co nejvěrnější zobrazení živých tvorů – od jemných
            detailů srsti a lesku v očích až po hru světla a stínu. Cílem je vytvořit tetování, které působí jako
            živé, s důrazem na emocionalitu, charakter a energii daného zvířete.
          </p>
          <p>
            Realistická zvířata se často používají jako symbol síly, svobody, věrnosti nebo instinktů, které si člověk
            spojuje se svým vlastním příběhem. Každé tetování je originál, který přenáší osobnost i duši zvířete přímo
            na kůži.
          </p>
        </div>

        <button class="portfolio-toggle" type="button">
          Více
        </button>

                <div class="portfolio-gallery">
          <button
            class="portfolio-gallery__arrow portfolio-gallery__arrow--prev"
            type="button"
            aria-label="Předchozí obrázek"
          >
            ←
          </button>

          <div class="portfolio-gallery__track">
            {realismImages.map((image, index) => (
              <figure class="portfolio-gallery__item">
                <img
                  src={image.default.src}
                  alt={`Realistické tetování ${index + 1}`}
                  loading="lazy"
                  class="portfolio-gallery__image"
                />
              </figure>
            ))}
          </div>

          <button
            class="portfolio-gallery__arrow portfolio-gallery__arrow--next"
            type="button"
            aria-label="Další obrázek"
          >
            →
          </button>
        </div>
      </div>
    </article>
  </section>

    <script is:inline>
    document.addEventListener('DOMContentLoaded', function () {
      // --- Rozbalování / sbalování textu ---
      document.querySelectorAll('.portfolio-style').forEach(function (section) {
        var description = section.querySelector('.portfolio-description');
        var toggleButton = section.querySelector('.portfolio-toggle');

        if (!description || !toggleButton) return;
        if (!(description instanceof HTMLElement)) return;
        if (!(toggleButton instanceof HTMLButtonElement)) return;

        toggleButton.addEventListener('click', function () {
          var isExpanded = description.dataset.expanded === 'true';
          description.dataset.expanded = isExpanded ? 'false' : 'true';
          toggleButton.textContent = isExpanded ? 'Více' : 'Méně';
        });
      });

      // --- Šipky pro galerii (desktop/tablet) ---
      document.querySelectorAll('.portfolio-gallery').forEach(function (gallery) {
        var track = gallery.querySelector('.portfolio-gallery__track');
        var prevBtn = gallery.querySelector('.portfolio-gallery__arrow--prev');
        var nextBtn = gallery.querySelector('.portfolio-gallery__arrow--next');

        if (!track || !prevBtn || !nextBtn) return;
        if (!(track instanceof HTMLElement)) return;

        var items = track.querySelectorAll('.portfolio-gallery__item');
        if (items.length <= 1) {
          prevBtn.setAttribute('hidden', 'true');
          nextBtn.setAttribute('hidden', 'true');
          return;
        }

        function updateArrows() {
          var maxScroll = track.scrollWidth - track.clientWidth;
          var current = track.scrollLeft;

          if (current <= 2) {
            prevBtn.setAttribute('hidden', 'true');
          } else {
            prevBtn.removeAttribute('hidden');
          }

          if (current >= maxScroll - 2) {
            nextBtn.setAttribute('hidden', 'true');
          } else {
            nextBtn.removeAttribute('hidden');
          }
        }

        function scrollByOne(direction) {
          // posun o cca "jednu fotku" – 80 % šířky tracku
          var amount = track.clientWidth * 0.55;
          track.scrollBy({
            left: direction * amount,
            behavior: 'smooth'
          });
        }

        prevBtn.addEventListener('click', function () {
          scrollByOne(-1);
        });

        nextBtn.addEventListener('click', function () {
          scrollByOne(1);
        });

        track.addEventListener('scroll', function () {
          // při ručním posunu / swipu aktualizujeme viditelnost šipek
          updateArrows();
        });

        // inicializace po načtení
        window.addEventListener('load', updateArrows);
        updateArrows();
      });
    });
  </script>
</BaseLayout>