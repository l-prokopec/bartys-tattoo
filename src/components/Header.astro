---
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---

<header class="site-header">
    <nav class="site-nav" data-open="false">
        <ul>
            <li><a href={`${base}/`}>Úvodní stránka</a></li>
            <li><a href={`${base}/about/`}>O mně</a></li>
            <li><a href={`${base}/studio/`}>Studio</a></li>
            <li><a href={`${base}/portfolio/`}>Portfolio</a></li>
            <li><a href={`${base}/merch/`}>Merch</a></li>
        </ul>
    </nav>
    <button class="nav-toggle" type="button" aria-label="Otevřít navigaci" aria-expanded="false">
        <span class="nav-toggle__bar"></span>
        <span class="nav-toggle__bar"></span>
        <span class="nav-toggle__bar"></span>
    </button>
</header>

<script type="module">
    const nav = document.querySelector('.site-nav');
    const button = document.querySelector('.nav-toggle');
    const MOBILE_BREAKPOINT = 900;
    const CLOSE_DELAY = 380;

    if (nav && button) {
        const setOpen = (isOpen) => {
            nav.dataset.open = isOpen ? 'true' : 'false';
            button.setAttribute('aria-expanded', String(isOpen));
        };

        const isMobile = () => window.innerWidth <= MOBILE_BREAKPOINT;

        const handleResize = () => {
            setOpen(!isMobile());
        };

        handleResize();
        window.addEventListener('resize', handleResize);

        button.addEventListener('click', () => {
            const isOpen = nav.dataset.open === 'true';
            setOpen(!isOpen);
        });

        nav.querySelectorAll('a').forEach((link) => {
            link.addEventListener('click', () => {
                if (isMobile()) {
                    window.setTimeout(() => setOpen(false), CLOSE_DELAY);
                }
            });
        });
    }
</script>
